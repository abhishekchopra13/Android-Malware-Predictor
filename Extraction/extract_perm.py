import xml.etree.ElementTree as ET
import pandas as pd
import os
#Default Permissions
print("Reading Default Permissions\n")
f = open("DefaultPermList.txt","r")
DefaultPerm = f.readlines()
print("Default permissions read\n")
#The following list l has permissions used by the app
l = list(DefaultPerm)
# This extracts permissions in xml file
print("Extracting features from test.apk file\n")
os.system("androguard axml -o test.xml test.apk")
root = ET.parse("test.xml").getroot()
permissions = root.findall("uses-permission")
# Initialising the dictionary d
d = {}
for x in set(l):
    d[x] = 0
for perm in permissions:
    for att in perm.attrib:
        d[perm.attrib[att]] = 1
        # print("{}\n".format(perm.attrib[att])) Marking the permission found to be 1
df = pd.DataFrame.from_dict(d, orient='index')
df.to_csv('Permcsvfile.csv', index=True,header = True)
print("Features Extracted data has been saved to Permcsvfile.csv\n")



